<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>ASP Repeater helper to output class names on every Nth item</title>
        <meta name="viewport" content="width=device-width">

        <link href='http://fonts.googleapis.com/css?family=Audiowide' rel='stylesheet' type='text/css'>
        
        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Digiguru.co.uk</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>ASP Repeater helper to output class names on every Nth item</h2>
<p class="meta">06 Feb 2014</p>

<div class="post">
<p>I came across a need to output a “clear” class to every 5th item in an asp:repeater. Here’s an over-simplified example of the code that was written.</p>

<div class="highlight"><pre><code class="language-aspx-vb" data-lang="aspx-vb">&lt;ul&gt;
&lt;asp:Repeater runat=&#39;server&#39;&gt;
    &lt;ItemTemplate&gt;
        &lt;li class=&#39;&lt;%# If((Container.DataItemIndex + 1 Mod 5).Equals(0), &quot;clear&quot;, &quot;&quot;) %&gt;&#39;&gt;
            &lt;%# Container.DataItem.Title %&gt;
        &lt;/li&gt;
    &lt;/ItemTemplate&gt;
&lt;/asp:Repeater&gt;
&lt;/ul&gt;</code></pre></div>

<p>I say we could to better. First - let’s work out what we want to say. Every 5th item output a new class. 
To determine if we are the fith item, we need to know the currentIndex and add 1 as it’s 0 based.</p>

<p>So let’s write pseudo code of what we actually want:</p>

<div class="highlight"><pre><code class="language-aspx-vb" data-lang="aspx-vb">&lt;li class=&#39;&lt;%# Container.Every5thItem(&quot;clear&quot;) %&gt;&#39;&gt;...&lt;/li&gt;</code></pre></div>

<p>Okay - that feels better, but I think we could improve it by having ‘5’ as a parameter, I know that we might decide to change the width of this repeater later, and thus need to change which item clears.</p>

<div class="highlight"><pre><code class="language-aspx-vb" data-lang="aspx-vb">&lt;li class=&#39;&lt;%# Container.Every(5).Output(&quot;clear&quot;) %&gt;&#39;&gt;...&lt;/li&gt;</code></pre></div>

<p>Nice - that’s a descriptive way of outputting a the “clear” class on every 5th item, and allows us to change the params depending on our needs. But how do we write the code?</p>

<div class="highlight"><pre><code class="language-vbnet" data-lang="vbnet">Public Module RepeaterHelper
    &lt;System.Runtime.CompilerServices.Extension()&gt;
    Public Function Every(container As IDataItemContainer, nthItem As Integer) As ...
        
    End Function
End Module</code></pre></div>

<p>So this is the skeleton that allows us to extend the “Container” object in a repeater, adding “Every” as a function to any IDataItemContainer in your project. Now we need to return an object that exposes an Output function…</p>

<div class="highlight"><pre><code class="language-vbnet" data-lang="vbnet">Public Module RepeaterHelper

    &lt;System.Runtime.CompilerServices.Extension()&gt;
    Public Function Every(container As IDataItemContainer, nthItem As Integer) As Itemiser
        Return New Itemiser(container.DataItemIndex, nthItem)
    End Function


    Public Class Itemiser
        Public Sub New(ByVal currentIndex As Integer, ByVal item As Integer)
            Me.ItemCount = item
            Me.CurrentIndex = currentIndex
        End Sub
        Property ItemCount As Integer
        Property CurrentIndex As Integer
        Public Function Output(ByVal text As String) As String
            Return If(((CurrentIndex + 1) Mod 5).Equals(0), text, &quot;&quot;)
        End Function
    End Class

End Module</code></pre></div>

<p>ANd that’s it - outputting a class on every 5th item in a repeater.</p>

</div>


              
              
              <div id="disqus_thread"></div>
              
            <div class="footer">
              <div class="contact">
                <p>
                  Name<br />
                  What You Are<br />
                  digiguru@gmail.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/digiguru/">github.com/digiguru</a><br />
                  <a href="http://twitter.com/thedigiguru/">twitter.com/thedigiguru</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-123008-9', 'digiguru.co.uk');
ga('require', 'linkid', 'linkid.js');
ga('send', 'pageview');

</script>
   
<script type="text/javascript">
    var disqus_shortname = 'digigurucouk';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

  
    </body>
</html>
