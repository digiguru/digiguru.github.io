<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Becoming a polyglot programmer</title>
        <meta name="viewport" content="width=device-width">

        <link href='http://fonts.googleapis.com/css?family=Audiowide' rel='stylesheet' type='text/css'>
        
        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Digiguru.co.uk</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>Becoming a polyglot programmer</h2>
<p class="meta">08 May 2014</p>

<div class="post">
<p>Recently i’ve been sprinting preparing a very exciting new venture that has force me to write code in languages I had little experience in before. The amazing thing I have learnt is that it’s fairly striaghtforward to transfer skills from other languages fairly seemlessly once you’ve invested time in. The fundamental thing I have realised is good code architecture is universal.</p>

<p>What I like to bring to code is simplification, atomicity and structured design. Consider the following java code…</p>

<div class="highlight"><pre><code class="language-java" data-lang="java">public class SearchFragment extends Fragment {
	private final String SEARCH_URL = RequestConstants.SERVER_GUEST_URL+&quot;search/&quot;;
	
	private Handler searchServiceHandler = new Handler() {

		public void handleMessage(Message msg) {
            //Reads the data from a JSON response
            //Displays an alert if there is an error.
			//Puts data into an intent object on response. 
            // (60 lines)
        }
	};
	
	@Override
	public View onCreateView(LayoutInflater inflater, ViewGroup container,
			Bundle savedInstanceState) {
        
        //Gets saved data from local cache, reads from a JSON array
        //Displays an alert if there is an error.
        //Record some flurry events
        //Setup some user interaction - if text box is subitted start a task in another thread.
        // (90 lines)    
            
	}
    
	class SearchServiceTask extends AsyncTask&lt;String, Void, Void&gt;
	{
        //Kicking off a background task.
        //Display loading panel
        //Define HttpRequest
        //Submit request
        //Recieve response
        //Catch all errors and log, and copile a list

		protected void onPreExecute() {
			//Start Progress Dialog (Message)
            //(5 lines)
		}
        
		@Override
		protected Void doInBackground(String... details) {
            //Make the request
            //Read the response
            //Log any errors
            //(50 lines)
		}

		protected void onPostExecute(Void unused) {
			// Close progress dialog
            //If errors show a message
			//If successful result call the searchServiceHandler.
            //Update UI elements
            (40 lines)
		}
	}
}</code></pre></div>

<p>For me it just feels like it’s doing too much. Worse still the same style was duplicated in every web request.</p>

<p>The first thing I did was define an interface that I wanted this to follow fro an API level.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java">//First let&#39;s define the completion block
//all we care about is &quot;What&#39;s the result?&quot; or &quot;Why did it fail?&quot; 
interface IBlockList&lt;listType&gt; {
	void success(List&lt;listType&gt; list);
	void error(String message);
}

interface IServiceWedding {
	
	void  searchBySearchText (
        
        String searchText, 
        String domain, 
        IBlockList&lt;SearchResult&gt; completeBlock);
	
}</code></pre></div>

<p>Very simple interface, I can drop that into any file and not care about JSON, HTTP Requests, Asyncronosity. Just raw input output.</p>

<p>Now all I have to do is write each of the parts in isolation.</p>

<div class="highlight"><pre><code class="language-java" data-lang="java">public class DataService implements IServiceWedding {
	
    //These 2 functions will probably move to a base class.
	private HttpResponse makeGetRequest(String url) throws Exception 
	{
		//Make a get request with all the headers
        //(10 lines)
	}
	private String getResultText(String url) throws Exception {
		//Use a URL and call makeGetRequest, read the result into a string.
        //(20 lines)
	}
	
    //These 2 functions could probably be reused for any service that returns the same data.
	private ArrayList&lt;SearchResult&gt; readSearchResultList (String response) throws JSONException {
		//Read a JSON string into a list of SearchResult
        //(10 lines)
	}
	
	private SearchResult readSearchResult (String response) throws JSONException {
		//Read a JSON string into a SearchResult
        //(2 lines)
	}
	
    //Finally the implementation. Every time you want a new websevice, this is all you have to write!
	@Override
	public void searchWeddingBySearchText(String searchText, String domain,
			IBlockList&lt;SearchResult&gt; completeBlock) {
            
        String url = getDomainUrl(domain) + &quot;search/&quot; + searchText;
		
		try {
			String textResult = getResultText(url);
			completeBlock.success(this.readSearchResultList(textResult));
		} catch (JSONException e) {
			completeBlock.error(&quot;Could not process the data from the server&quot;);
		} catch (Exception e1) {
			completeBlock.error(&quot;Error reading data from the server&quot;);
		}
	}
}</code></pre></div>

<p>I certainly prefer the second style. It’s how I’d write the code in any language, define the right interface and then use it.</p>


</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Name<br />
                  What You Are<br />
                  digiguru@gmail.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/digiguru/">github.com/digiguru</a><br />
                  <a href="http://twitter.com/thedigiguru/">twitter.com/thedigiguru</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-123008-9', 'digiguru.co.uk');
ga('require', 'linkid', 'linkid.js');
ga('send', 'pageview');

</script>
    </body>
</html>
